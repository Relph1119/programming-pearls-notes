# 第1章 开篇

## 1.1 任务背景

- 需要在一个大系统中排序，排序的内容是文件。
- 文件最多包含1千万条记录，每条记录都是7位的整数。
- 只有1MB的内存可用。

## 1.2 准确的问题描述 

**输入：**一个最多包含$n$个正整数的文件，每个数都小于$n$，其中$n=10^7$。如果在输入文件中有任何整数重复出现就是致命错误。没有其他数据与该正整数相关联。

**输出：**按升序排列的输入整数的列表。

**约束：**最多有（大约）1MB的内存空间可用，有充足的磁盘存储空间可用。运行时间最多几分钟，运行时间为10秒就不需要进一步优化了。

## 1.3 程序设计

设计方案一：以一般的基于磁盘的归并排序程序为起点，可以将原有的200行程序减少为几十行，但是完成程序并使之运行可能仍然需要几天的时间。

设计方案二：利用排序问题的特殊性
- 每个号码使用7个字节存储，在可用的1MB存储空间中，大约可以存143000个号码。
- 如果每个号码使用32位整数表示，在1MB存储空间中，可以存储250000个号码。
- 处理所有号码，需要遍历输入文件40趟。

## 1.4 位图方案的实现概要

设计方案三：使用位图或位向量表示集合。
- 由于每个7位十进制整数表示一个小于1000万的整数，可以使用一个具有1000万个位的字符串来表示这个文件。
- 当且仅当整数$i$在文件中存在时，第$i$位为1。

具体步骤：
1. 将所有的位都置0，从而将集合初始化为空。
2. 通过读入文件中的每个整数建立集合，将每个对应的位都置为1。
3. 检验每一位，如果该位为1，输入对应的整数，产生有序的输出文件。

## 1.5 原理

上述程序的一般性原理：
- 正确的问题：明确问题。
- 位图数据结构：该数据结构描述了一个有限定义域内的稠密集合，其中的每一个元素最多出现一次，并且没有其他任何数据与该元素相关联。
- 多趟算法：多次读入其输入数据，每次完成一步。
- 时间-空间折中与双赢：通过使用更多的时间，可以减少程序所需的空间。
- 简单的设计：设计者确定其设计已经达到了完美的标准，不是不能再增加任何东西，而是不能再减少任何东西。
- 程序设计的阶段
